                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title> </title>
<link href="css/style.css" rel="stylesheet" type="text/css">

<script type="text/javascript">

    function addToCart(itemName)
    {
        resetInactiveTime()
        m = products[itemName];
        if (!m || !m.quantity)
        {
            alert("Sorry, but " + itemName + " is out of stock");
            return;
        }
        m.quantity = m.quantity - 1;

        if (m.quantity == 0)
            showButtonAdd(false, itemName);

        n = cart[itemName];
        if (!n)
        {
            cart[itemName] = 1;
            showButtonRem(true, itemName);
        }
        else
        {
            cart[itemName] = n + 1;
        }

        cartSum = cartSum + m.price;
        cartCount = cartCount + 1;
        UpdateCartSum(cartSum);
    }
    function removeFromCart(itemName)
    {
        resetInactiveTime()
        m = cart[itemName];
        if (m)
        {
            if (m == 1) {
                delete cart[itemName];
                showButtonRem(false, itemName);
            }
            else
                cart[itemName] = m - 1;
            p = products[itemName];
            p.quantity = p.quantity + 1;

            if (p.quantity == 1)
                showButtonAdd(true, itemName);

            cartSum = cartSum - p.price;
            cartCount = cartCount - 1;
            UpdateCartSum(cartSum);
        }
        else {
            alert("There is no " + itemName + " in  cart");
        }
    }

    function showButtonAdd(visible, id)
    {
        e = document.getElementById(id).getElementsByClassName("add");
        if (!e) return;

        if (visible)
            e[0].style.visibility = 'visible';
        else
            e[0].style.visibility = 'hidden';
    }
    function showButtonRem(visible, id) {
        e = document.getElementById(id).getElementsByClassName("rem");
        if (!e) return;

        if (visible)
            e[0].style.visibility = 'visible';
        else
            e[0].style.visibility = 'hidden';
    }
</script>
</head>
<body>
    <script type="text/javascript">
        var showingCart = false;
        var inactiveTime = 0;
        var cartSum = 0;
        var cartCount = 0;
        var cart = {
        };
        var productList = [
            'Box1',
            'Box2',
            'Clothes1',
            'Clothes2',
            'Jeans',
            'Keyboard',
            'KeyboardCombo',
            'Mice',
            'PC1',
            'PC2',
            'PC3',
            'Tent',
            ];

        var products = {};
        productList.forEach(function (product) {
            products[product] = {
                'price': Math.floor(Math.random() * 100) + 1,
                'quantity': 10,
            };
        });
    </script>
<div id="header">

	<div id="logo">
		BookStore
	</div>

	<div id="welcomeBanner">
		Welcome to my bookstore
        <button id="buttonShowCart" onclick="showCart(true)">Cart($0)</button>

        <script type="text/javascript">
            function UpdateCartSum(sum)
            {
                e = document.getElementById("buttonShowCart");
                e.innerText = "Cart($" + sum + ")";
            }
        </script>
	</div>

    </div>

    <div id="mainContent">

        <div id="navigationMenu">
            <a>All Items</a>
            <a>Books</a>
            <a>Clothing</a>
            <a>Tech</a>
            <a>Gifts</a>
            <a>Stationary</a>
            <a>Supplies</a>
        </div>

        <div id="productList">
            <div class="product" id="Box1">
                <img src="images/Box1_$10.png" />
                <img src="images/cart.png" class="cart"/>
                <button class="add" onclick="addToCart('Box1')">Add</button>
                <button class="rem" onclick="removeFromCart('Box1')">Remove</button>
                <div class="price"></div>
                <h4>Box1</h4>
            </div>
            <div class="product" id="Box2">
                <img src="images/Box2_$5.png" />
                <img src="images/cart.png" class="cart" />
                <button class="add" onclick="addToCart('Box2')">Add</button>
                <button class="rem" onclick="removeFromCart('Box2')">Remove</button>
                <div class="price"></div>
                <h4>Box2</h4>
            </div>

            <div class="product" id="Clothes1">
                <img src="images/Clothes1_$20.png" />
                <img src="images/cart.png" class="cart" />
                <button class="add" onclick="addToCart('Clothes1')">Add</button>
                <button class="rem" onclick="removeFromCart('Clothes1')">Remove</button>
                <div class="price"></div>
                <h4>Clothes1</h4>
            </div>

            <div class="product" id="Clothes2">
                <img src="images/Clothes2_$30.png" />
                <img src="images/cart.png" class="cart" />
                <button class="add" onclick="addToCart('Clothes2')">Add</button>
                <button class="rem" onclick="removeFromCart('Clothes2')">Remove</button>
                <div class="price"></div>
                <h4>Clothes2</h4>
            </div>

            <div class="product" id="Jeans">
                <img src="images/Jeans_$50.png" />
                <img src="images/cart.png" class="cart" />
                <button class="add" onclick="addToCart('Jeans')">Add</button>
                <button class="rem" onclick="removeFromCart('Jeans')">Remove</button>
                <div class="price"></div>
                <h4>Jeans</h4>
            </div>

            <div class="product" id="Keyboard">
                <img src="images/Keyboard_$20.png" />
                <img src="images/cart.png" class="cart" />
                <button class="add" onclick="addToCart('Keyboard')">Add</button>
                <button class="rem" onclick="removeFromCart('Keyboard')">Remove</button>
                <div class="price"></div>
                <h4>Keyboard</h4>
            </div>

            <div class="product" id="KeyboardCombo">
                <img src="images/KeyboardCombo_$40.png" />
                <img src="images/cart.png" class="cart" />
                <button class="add" onclick="addToCart('KeyboardCombo')">Add</button>
                <button class="rem" onclick="removeFromCart('KeyboardCombo')">Remove</button>
                <div class="price"></div>
                <h4>KeyboardCombo</h4>
            </div>

            <div class="product" id="Mice">
                <img src="images/Mice_$20.png" />
                <img src="images/cart.png" class="cart" />
                <button class="add" onclick="addToCart('Mice')">Add</button>
                <button class="rem" onclick="removeFromCart('Mice')">Remove</button>
                <div class="price"></div>
                <h4>Mice</h4>
            </div>

            <div class="product" id="PC1">
                <img src="images/PC1_$350.png" />
                <img src="images/cart.png" class="cart" />
                <button class="add" onclick="addToCart('PC1')">Add</button>
                <button class="rem" onclick="removeFromCart('PC1')">Remove</button>
                <div class="price"></div>
                <h4>PC1</h4>
            </div>

            <div class="product" id="PC2">
                <img src="images/PC2_$400.png" />
                <img src="images/cart.png" class="cart" />
                <button class="add" onclick="addToCart('PC2')">Add</button>
                <button class="rem" onclick="removeFromCart('PC2')">Remove</button>
                <div class="price"></div>
                <h4>PC2</h4>
            </div>

            <div class="product" id="PC3">
                <img src="images/PC3_$300.png" />
                <img src="images/cart.png" class="cart" />
                <button class="add" onclick="addToCart('PC3')">Add</button>
                <button class="rem" onclick="removeFromCart('PC3')">Remove</button>
                <div class="price"></div>
                <h4>PC3</h4>
            </div>

            <div class="product" id="Tent">
                <img src="images/Tent_$100.png" />
                <img src="images/cart.png" class="cart" />
                <button class="add" onclick="addToCart('Tent')">Add</button>
                <button class="rem" onclick="removeFromCart('Tent')">Remove</button>
                <div class="price"></div>
                <h4>Tent</h4>
            </div>
        </div>
    </div>

    <div id="footer">
        Inactive Time: 0 seconds
    </div>
    <script type="text/javascript">
        // query price for each product
        items = document.getElementById("productList").children
        for (i = 0; i < items.length; i = i + 1)
        {
            p = products[items[i].id];
            if (p)
            {
                items[i].getElementsByClassName("price")[0].innerText = "$" + p.price;
            }
        }

        // handle esc for cart for the bounus
        window.onkeydown = function (event) {
            if (showingCart && event.keyCode === 27)
            {
                showCart(false);
            }
        };

        function resetInactiveTime() {
            inactiveTime = 0;
        }
        function updateInactiveTime() {
            if (showingCart) return;

            inactiveTime = inactiveTime + 1;
            showInactiveTime(inactiveTime);

            if (inactiveTime > 3000) {
                alert("Hey there! Are you still planning to buy something?");
                inactiveTime = 0;
            }
        }
        function showInactiveTime(t)
        {
            e = document.getElementById("footer");
            e.innerText = "Inactive Time: " + t + " seconds";
        }

        // do the monitor job
        setInterval(updateInactiveTime, 1000);

        function showCart(visible) {
            el = document.getElementById("cart");
            if (visible)
            {
                showingCart = true;
                el.style.display = 'block';
                showCartInfo();
                
            }
            else
            {
                showingCart = false;
                el.style.display = 'none';
            }
        }

        function showCartInfo() {
            cartInfoEl = document.getElementById("cartInfo");
            cartInfoHtml = "";
            for (product in cart)
            {
                count = cart[product];
                if (count) {
                    cartInfoHtml = cartInfoHtml +
                        ("\n<div id='inCart" + product + "' class='productCount'><span>" + product + "</span><span class='updater'><button onClick=\"addProductInCart('" + product + "',-1)\">-</button><span id='inCartCount" + product + "'>" + count + "</span><button onClick=\"addProductInCart('" + product + "',1)\">+</button></span></div>");
                }
            }

            if (cartCount == 0)
                cartInfoEl.innerText = "nothing here...";
            else
                cartInfoEl.innerHTML = cartInfoHtml;

            cartSubtotal();
        }
        function addProductInCart(itemName, number)
        {
            if (number > 0)
                addToCart(itemName);
            else
                removeFromCart(itemName);

            n = cart[itemName];
            if (!n)
            {
                // delete it from cart
                cartInfoEl = document.getElementById("cartInfo");
                el = document.getElementById("inCart" + itemName);
                cartInfoEl.removeChild(el);
            }
            else
            {
                el = document.getElementById("inCartCount" + itemName);
                el.innerText = n;
            }

            cartSubtotal();
        }
        function cartSubtotal()
        {
            // show sum
            el = document.getElementById("cartSum");
            el.innerText = "Subtotal (" + cartCount + " items): $" + cartSum;
        }
    </script>

    <div class="modalCart" id="cart">
        <div class="box">
            <button class="close" onclick="showCart(false)">X</button>
            <p class="title">See what's in your cart</p>
            <div class="content" id="cartInfo">
            </div>
            <div class="foot">
                <span id="cartSum"></span>
                <button class="checkout">Check out</button>
            </div>

        </div>
    </div>

    </body>
    </html>
